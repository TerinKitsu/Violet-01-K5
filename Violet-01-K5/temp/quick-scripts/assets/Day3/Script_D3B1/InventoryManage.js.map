{"version":3,"sources":["InventoryManage.js"],"names":["dataItem","cc","Class","name","properties","keyItem","image","SpriteFrame","nameItem","type","quantity","effect","extends","Component","holder","Node","item","Prefab","rightPanel","useBtn","dropBtn","messageLb","Label","showImage","Sprite","showName","showType","showQuantity","showEffect","listData","default","currentItemNode","currentItemData","onLoad","node","on","itemClick","start","i","length","data","instantiate","parent","emit","event","active","stopPropagation","getUserData","log","itemData","spriteFrame","string","target","onUseItem","showMessage","destroy","removeItemFromList","getComponent","initData","onDropItem","key","filter","text","tween","delay","call"],"mappings":"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","file":"InventoryManage.js","sourceRoot":"../../../../../assets/Day3/Script_D3B1","sourcesContent":["const dataItem = cc.Class({\n    name: \"dataItem\",\n    properties: {\n        keyItem: \"\",\n        image: cc.SpriteFrame,\n        nameItem: \"\",\n        type: \"\",\n        quantity: 0,\n        effect: \"\",\n    }\n});\n\n\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        holder: cc.Node,\n        item: cc.Prefab,\n        rightPanel: cc.Node,\n        useBtn: cc.Node,\n        dropBtn: cc.Node,\n        messageLb: cc.Label,\n\n        showImage: cc.Sprite,\n        showName: cc.Label,\n        showType: cc.Label,\n        showQuantity: cc.Label,\n        showEffect: cc.Label,\n\n        listData: {\n            default: [],\n            type: dataItem,\n        }\n    },\n    \n    currentItemNode: null,\n    currentItemData: null,\n\n    onLoad(){\n        this.node.on(\"ON_ITEM_CLICK\", this.itemClick, this);\n        // this.node.on(\"ON_ITEM_USE\", this.onUseItem, this);\n    },\n\n    start(){\n        for(let i = 0; i < this.listData.length; i++){\n            const data = this.listData[i];\n            const item = cc.instantiate(this.item);\n            item.parent = this.holder;\n            // item.newItemComp.initData();\n            item.emit(\"INIT_DATA\", data);\n        }\n    },\n\n   itemClick(event){\n\n    this.rightPanel.active = true;\n    event.stopPropagation();\n    const data = event.getUserData();\n\n    cc.log(data.itemData.type == \"Craft\");\n    data.itemData.type == \"Craft\" ? this.useBtn.active = false : this.useBtn.active = true;\n    this.dropBtn.active = true;\n\n    // cc.log(\"itemCLick\", data);\n    this.showImage.spriteFrame = data.itemData.image;//itemData lấy từ onClick của Item.JS\n    this.showName.string = data.itemData.nameItem;\n    this.showQuantity.string = data.itemData.quantity;\n    this.showType.string = data.itemData.type;\n    this.showEffect.string = data.itemData.effect;\n\n    this.currentItemNode = event.target;\n    this.currentItemData = data.itemData;\n   },   \n\n    onUseItem() {\n        if (!this.currentItemNode || !this.currentItemData) return;\n\n        const type = this.currentItemData.type;\n\n        if (type === \"Equipment\") {\n            this.showMessage(`Đã trang bị:  ${this.currentItemData.nameItem}`);\n            this.currentItemNode.destroy();\n            this.removeItemFromList(this.currentItemData.keyItem);\n        } \n        else if (type === \"Consumable\") {\n            this.currentItemData.quantity--;\n            if (this.currentItemData.quantity <= 0) {\n                this.currentItemNode.destroy();\n                this.removeItemFromList(this.currentItemData.keyItem);\n            } else {\n                this.currentItemNode.getComponent(\"Item\").initData(this.currentItemData);\n                this.showQuantity.string = this.currentItemData.quantity;\n            }\n        }\n    },\n\n    onDropItem() {\n        if (!this.currentItemNode || !this.currentItemData) return;\n\n        this.currentItemNode.destroy();\n        this.removeItemFromList(this.currentItemData.keyItem);\n    },\n\n    removeItemFromList(key) {\n        this.listData = this.listData.filter(item => item.keyItem !== key);\n        this.rightPanel.active = false;\n    },\n\n    showMessage(text) {\n        this.messageLb.string = text;\n        this.messageLb.node.active = true;\n    \n        // Hide Label after 1 second\n        cc.tween(this.messageLb.node)\n            .delay(1)\n            .call(() => {\n                this.messageLb.node.active = false;\n            })\n            .start();\n    }\n});\n"]}